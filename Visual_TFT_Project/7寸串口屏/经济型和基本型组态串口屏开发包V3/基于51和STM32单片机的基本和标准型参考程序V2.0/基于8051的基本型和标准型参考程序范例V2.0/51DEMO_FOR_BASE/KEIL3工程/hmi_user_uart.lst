C51 COMPILER V8.02   HMI_USER_UART                                                         12/27/2013 09:38:01 PAGE 1   


C51 COMPILER V8.02, COMPILATION OF MODULE HMI_USER_UART
OBJECT MODULE PLACED IN hmi_user_uart.obj
COMPILER INVOKED BY: d:\Keil51801\C51\BIN\C51.EXE src\hmi_user_uart.c OMF2 WARNINGLEVEL(1) OPTIMIZE(9,SPEED) BROWSE DEBU
                    -G PRINT(.\hmi_user_uart.lst) OBJECT(hmi_user_uart.obj)

line level    source

   1          /************************************版权申明********************************************
   2          **                             广州大彩光电科技有限公司                                
   3          **                             http://www.gz-dc.com
   4          **-----------------------------------文件信息--------------------------------------------
   5          ** 文件名称:   hmi_user_uart.c 
   6          ** 修改时间:   2011-05-18
   7          ** 文件说明:   用户MCU串口驱动函数库
   8          ** 技术支持：  Tel: 020-22077476  Email: hmi@gz-dc.com  
   9          /**--------------------------------------------------------------------------------------
  10                  
  11          /**--------------------------------------------------------------------------------------    
  12                                            使用必读                      
  13             hmi_user_uart.c中的串口发送接收函数共3个函数：串口初始化Uartinti()、发送1个字节SendChar()、
  14             发送字符串SendStrings().目前暂时只提供8051驱动平台，如果用户MCU非8051平台，需要修改底层寄
  15             存器设置,但禁止修改函数名称，否则无法与HMI驱动库(hmi_driver.c)匹配。 
  16          /**--------------------------------------------------------------------------------------*/
  17          
  18          #include "hmi_user_uart.h"
  19          
  20          /*----------------------------------------------------------------------------------------
  21          **                          1. 基于51平台串口驱动
  22          /*----------------------------------------------------------------------------------------
  23          
  24          /****************************************************************************
  25          * 名    称： UartInit()
  26          * 功    能： 串口初始化
  27          * 入口参数： 无      
  28          * 出口参数： 无
  29          ****************************************************************************/
  30          
  31          
  32          void UartInit( )
  33          { 
  34   1        SCON=0x50;     //8位UART，BPS可变,允许串行接收控制位
  35   1        TMOD |=0x20;   //定时器1工作方式2(8位自动重装方式)
  36   1        PCON |=0x80;   //波特率加倍
  37   1        TH1=0xFF;  
  38   1        TL1=0xFF;      //115200波特率 ，22.1184M 
  39   1        IE |=0X90;     //Enable Serial Interrupt 
  40   1        TR1=1;
  41   1          
  42   1        }
  43                  
  44          
  45          /*****************************************************************
  46          * 名    称： SendChar()
  47          * 功    能： 发送1个字节
  48          * 入口参数： t  发送的字节       
  49          * 出口参数： 无                  
  50           *****************************************************************/
  51          void  SendChar(uchar t) 
  52           {      
  53   1          SBUF=t;
  54   1          while(TI==0);
C51 COMPILER V8.02   HMI_USER_UART                                                         12/27/2013 09:38:01 PAGE 2   

  55   1          TI=0;     
  56   1       } 
  57          /*****************************************************************
  58          * 名    称： SendStrings()
  59          * 功    能： 发送字符串
  60          * 入口参数： str  发送的字符串     
  61          * 出口参数： 无               
  62           *****************************************************************/
  63          
  64           void SendStrings(uchar *str)
  65           {
  66   1           while(*str)
  67   1               {
  68   2                SendChar(*str);
  69   2                str++;
  70   2               }
  71   1       } 
  72          
  73          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     48    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
